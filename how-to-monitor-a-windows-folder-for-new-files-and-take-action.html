<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=robots content="index,follow,noarchive"><title>How to Monitor a Windows Folder for New Files and Take Action - VibeJolt</title><meta name=description content="Files are in a constant state of flux on any operating system. Sometimes they get created, sometimes they get deleted, sometimes they get changed, and those are all normal things for an operating system to do. Sometimes when a file gets changed, it can cause instability in another application that depends on it, such as"><meta name=author content="Some Person"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"VibeJolt","url":"\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"\/how-to-monitor-a-windows-folder-for-new-files-and-take-action.html","name":"How to monitor a windows folder for new files and take action"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"Larita Shotwell"},"headline":"How to Monitor a Windows Folder for New Files and Take Action","description":"Files are in a constant state of flux on any operating system. Sometimes they get created, sometimes they get deleted, sometimes they get changed, and those are all normal things for an operating system to do. Sometimes when a file gets changed, it can cause instability in another application that depends on it, such as","inLanguage":"en","wordCount":998,"datePublished":"2024-02-02T00:00:00","dateModified":"2024-02-02T00:00:00","image":"\/img\/avatar-icon.png","keywords":[""],"mainEntityOfPage":"\/how-to-monitor-a-windows-folder-for-new-files-and-take-action.html","publisher":{"@type":"Organization","name":"\/","logo":{"@type":"ImageObject","url":"\/img\/avatar-icon.png","height":60,"width":60}}}</script><meta property="og:title" content="How to Monitor a Windows Folder for New Files and Take Action"><meta property="og:description" content="Files are in a constant state of flux on any operating system. Sometimes they get created, sometimes they get deleted, sometimes they get changed, and those are all normal things for an operating system to do. Sometimes when a file gets changed, it can cause instability in another application that depends on it, such as"><meta property="og:image" content="/img/avatar-icon.png"><meta property="og:url" content="/how-to-monitor-a-windows-folder-for-new-files-and-take-action.html"><meta property="og:type" content="website"><meta property="og:site_name" content="VibeJolt"><meta name=twitter:title content="How to Monitor a Windows Folder for New Files and Take Action"><meta name=twitter:description content="Files are in a constant state of flux on any operating system. Sometimes they get created, sometimes they get deleted, sometimes they get changed, and those are all normal things for an operating â€¦"><meta name=twitter:image content="/img/avatar-icon.png"><meta name=twitter:card content="summary"><meta name=twitter:site content="@username"><meta name=twitter:creator content="@username"><link href=./img/favicon.ico rel=icon type=image/x-icon><meta name=generator content="Hugo 0.98.0"><link rel=alternate href=./index.xml type=application/rss+xml title=VibeJolt><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://assets.cdnweb.info/hugo/bh/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://assets.cdnweb.info/hugo/bh/css/highlight.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/bh/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous></head><body><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>How to Monitor a Windows Folder for New Files and Take Action</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on February 2, 2024
&nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;5&nbsp;minutes
&nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;998&nbsp;words
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Larita Shotwell</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><img src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2019/10/4b8ecad3.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><h3>Quick Links</h3><ul class=table-content-level-1><li><a href=#>Instantiating the FileSystemWatcher</a></li></ul><ul class=table-content-level-1><li><a href=#>Triggering Events from the FileSystemWatcher</a></li></ul><ul class=table-content-level-1><li><a href=#>Defining Actions to Take</a></li></ul><ul class=table-content-level-1><li><a href=#>Using the Register-ObjectEvent</a></li></ul><ul class=table-content-level-1><li><a href=#>Testing It Out</a></li></ul><p>Files are in a constant state of flux on any operating system. Sometimes they get created, sometimes they get deleted, sometimes they get changed, and those are all normal things for an operating system to do. Sometimes when a file gets changed, it can cause instability in another application that depends on it, such as changing a port number in a properties file, a parameter in a deployment manifest, or even fixing code in production without going through source control.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>As part of managing these operating systems, engineers need a way to watch what happens to these critical files and take action when something does. Enter the .NET <a href=#>FileSystemWatcher class</a> and PowerShell.</p><p>In .NET and .NET Core, FileSystemWatcher is a class that lives in the System.IO namespace and monitors files. In PowerShell, this can be very useful, especially when it's combined with other PowerShell functions.</p><h2 id=instantiating-the-filesystemwatcher>Instantiating the FileSystemWatcher</h2><p>Instantiate this class in PowerShell by running</p><pre><code class="hljs php">$watcher = <span class=hljs-keyword>New</span>-Object System.IO.FileSystemWatcher</code> </pre><p>. Once you do, you'll need to tell it which folder to watch. You do this by setting the Path parameter on the FileSystemWatcher object to the path of whichever folder you want it to watch. If you have a folder on Windows called WatchThisFolder under C:, you would set the FileSystemWatcher to that by running</p><pre><code class="hljs php">$watcher.Path = <span class=hljs-string>'C:WatchThisFolder'</span></code> </pre><p>.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Because this class is also in .NET Core, you can do all this on a Linux or Mac OS system the same way you would on a Windows system. For example, if you had a folder on Ubuntu Linux called WatchThisFolder under your current user directory, you would run</p><pre><code class="hljs php">$watcher.Path = <span class=hljs-string>'/home/ubuntu/WatchThisFolder'</span></code> </pre><p>.</p><p>The rest of the code samples in this article work on either platform without any changes.</p><h2 id=triggering-events-from-the-filesystemwatcher>Triggering Events from the FileSystemWatcher</h2><p>Now that you have a new FileSystemWatcher object, you can take a look under the hood and try to figure it out. To see the specific types of file system events that the FileSystemWatcher is watching for, enter</p><pre><code class="hljs php">$watcher | Get-Member -MemberType Event</code> </pre><p>. <a href=#>Get-Member</a>&nbsp;shows everything that the object passed into it contains, and by adding the MemberType filter, you can see a certain category, in this case, events.</p><p>Those events are:</p><ul><li>Changed</li><li>Created</li><li>Deleted</li><li>Disposed</li><li>Error</li><li>Renamed</li></ul><p>When one or more of these FileSystemWatcher events is detected at the path the object is set to watch, the watcher object raises an external event, for which you can define actions.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Now that the watcher object knows what to watch, and you know what events it's watching for, you must set it to raise an event when an action is detected. Do this by running</p><pre><code class="hljs php">$watcher.EnableRaisingEvents = $true</code> </pre><p>. Think of this flag as an on/off switch for</p><pre><code class="hljs php">$watcher</code> </pre><p>: If the switch is off, nothing is going to happen if any changes are made. You can also tell it to look at files and folders nested under the one set in the path by changing the IncludeSubdirectories flag to true in the same way you did the EnableRaisingEvents flag.</p><h2 id=defining-actions-to-take>Defining Actions to Take</h2><p>Once the watcher object is set up, you must give it an action to perform once that change is detected. This can be as simple as writing to a system log, or as drastic as triggering a replacement of the instance with a clean pull of the source code. To get started, you need to define an action block in the code. Here's one just writes to the console:</p><pre>$action = {  <p> $path = $event.SourceEventArgs.FullPath</p>  <p> $name = $event.SourceEventArgs.Name</p>  <p> $changetype = $event.SourceEventArgs.ChangeType</p> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong>  <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong>  <p> Write-Host "File $name at path $path was $changetype at $(get-date)"</p>  <p>}</p></pre><p>You can see this code is pulling variables from the event using the <code>$event</code> variable, which is created for you when the event is created by the watcher object. As soon as the event terminates, the variable also terminates, meaning that it's only going to have data relevant to that event.</p><h2 id=using-the-register-objectevent>Using the Register-ObjectEvent</h2><p>So, you've got the FileSystemWatcher set up, and you've got actions that you want to take whenever something happens. Right now, these two are separate and don't know about each other. To get them working together, you must register the actions with the event. PowerShell has an entire cmdlet for this---the <a href=#>Register-ObjectEvent</a> cmdlet. To use Register-ObjectEvent, you must pass it three things:</p><ul><li>The FileSystemWatcher object</li><li>The event type to trigger the actions on</li><li>The actions you defined earlier</li></ul><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>If you've set up everything the same way it's listed above, it will look something like this: <code>Register-ObjectEvent $watcher 'Event Action' -Action $action.</code> 'Event Action' can be replaced with any event from the FileSystemWatcher, but this will make for a nice demo.</p><h2 id=testing-it-out>Testing It Out</h2><p>Now you can test it all out. In this section, you're going to create a new file in the specified directory, see the event action, then disable and deregister the event.</p><p>To create a new file and trigger the event, run the below line in PowerShell. This is on Ubuntu Linux, but if you're following along on Windows, replace /home/ubuntu/ with C: and / with .</p><pre>New-Item -Path "/home/ubuntu/WatchThisFolder/newFile" -ItemType File</pre><p>As soon as you enter that, the event fires and the action triggers.</p><pre>File newFile at path /home/ubuntu/WatchThisFolder/newFile was Created at 09/26/2019 20:49:54</pre><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>It fires every time you create a new file in that directory or anything nested under it, if you enabled the IncludeSubdirectories flag. Now that you know raising the event works, go and turn it off by running&nbsp;<code>$watcher.EnableRaisingEvents = $false</code>, then try creating a new file. The file should be created, but no event shows. This can be very useful if you are debugging and don't want to trigger anything while you are working in the file system.</p><p>Once you are done, run <code>Get-EventSubscriber | Unregister-Event</code> to unregister the event from the action. Now even if the EnableRaisingEvents flag is true and the action happens, the action won't fire.</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGibnq6fpcBwtM6wZK2nXaK8r7XTqKlmmV2stq%2BwzrCqZp6fobGmvoyfpqtlnprEbrLIpZysZZGjsW7AwKScZpmTqbawuo4%3D</p><hr><section id=social-share><div class="list-inline footer-links"><div class=share-box aria-hidden=true><ul class=share><li><a href="//twitter.com/share?url=%2fhow-to-monitor-a-windows-folder-for-new-files-and-take-action.html&text=How%20to%20Monitor%20a%20Windows%20Folder%20for%20New%20Files%20and%20Take%20Action&via=username" target=_blank title="Share on Twitter"><i class="fab fa-twitter"></i></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=%2fhow-to-monitor-a-windows-folder-for-new-files-and-take-action.html" target=_blank title="Share on Facebook"><i class="fab fa-facebook"></i></a></li><li><a href="//reddit.com/submit?url=%2fhow-to-monitor-a-windows-folder-for-new-files-and-take-action.html&title=How%20to%20Monitor%20a%20Windows%20Folder%20for%20New%20Files%20and%20Take%20Action" target=_blank title="Share on Reddit"><i class="fab fa-reddit"></i></a></li><li><a href="//www.linkedin.com/shareArticle?url=%2fhow-to-monitor-a-windows-folder-for-new-files-and-take-action.html&title=How%20to%20Monitor%20a%20Windows%20Folder%20for%20New%20Files%20and%20Take%20Action" target=_blank title="Share on LinkedIn"><i class="fab fa-linkedin"></i></a></li><li><a href="//www.stumbleupon.com/submit?url=%2fhow-to-monitor-a-windows-folder-for-new-files-and-take-action.html&title=How%20to%20Monitor%20a%20Windows%20Folder%20for%20New%20Files%20and%20Take%20Action" target=_blank title="Share on StumbleUpon"><i class="fab fa-stumbleupon"></i></a></li><li><a href="//www.pinterest.com/pin/create/button/?url=%2fhow-to-monitor-a-windows-folder-for-new-files-and-take-action.html&description=How%20to%20Monitor%20a%20Windows%20Folder%20for%20New%20Files%20and%20Take%20Action" target=_blank title="Share on Pinterest"><i class="fab fa-pinterest"></i></a></li></ul></div></div></section></article><ul class="pager blog-pager"><li class=previous><a href=./im-getting-ick-pay-boyfriend-html.html data-toggle=tooltip data-placement=top title="I'm getting the 'ick' because I have to pay for everything with my boyfriend">&larr; Previous Post</a></li><li class=next><a href=./helen-hunt-56-mad-fame-flaunts-incredibly-toned-figure-teeny-bikini-html.html data-toggle=tooltip data-placement=top title="Helen Hunt, 56, of Mad About You fame flaunts her incredibly toned figure in a teeny bikini">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href title=RSS><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted">All rights reserved
&nbsp;&bull;&nbsp;&copy;
2024
&nbsp;&bull;&nbsp;
<a href=./>VibeJolt</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.98.0</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous></script>
<script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script>
<script src=https://assets.cdnweb.info/hugo/bh/js/main.js></script>
<script src=https://assets.cdnweb.info/hugo/bh/js/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><script>$(document).ready(function(){$("pre.chroma").css("padding","0")})</script><script>renderMathInElement(document.body)</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://assets.cdnweb.info/hugo/bh/js/load-photoswipe.js></script>
<script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>